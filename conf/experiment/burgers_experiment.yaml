# @package _global_

# Burgers Equation Experiment
# 
# This is a comprehensive configuration for the Burgers equation problem.
# Modify the settings below based on your needs:
#
# Quick Test Mode:
#   - Set epochs: 2, train_sim: [0,1], val_sim: [2]
#   - Set mode: ['train'] (skip evaluation for speed)
#
# Physical Model:
#   - Change model_type: 'physical'
#   - Use trainer: physical or physical_with_suppression
#   - Add learnable_parameters under trainer_params
#
# Hybrid Training:
#   - Change model_type: 'hybrid'
#   - Use trainer: hybrid
#
# Data Generation:
#   - Add 'generate' to mode: ['generate', 'train', 'evaluate']
#   - Set generation_params.num_simulations as needed

defaults:
  - override /data: burgers_128
  - override /model/physical: burgers
  - override /model/synthetic: unet
  - override /trainer: physical
  - override /generation: default
  - override /evaluation: default

run_params:
  experiment_name: 'burgers_experiment'
  notes: 'Burgers equation with physical UNet model'
  mode: [ 'generate', 'train']  # Options: generate, train, evaluate
  model_type: 'physical'  # Options: synthetic, physical, hybrid

model:
  synthetic:
    model_save_name: 'burgers_unet_128'

generation_params:
  num_simulations: 1
  total_steps: 100
  save_interval: 1

trainer_params:
  # Training data
  train_sim: [0]  # Training simulations
  val_sim: [0]  # Validation simulations
  
  # Training hyperparameters
  epochs: 10  # For physical training, this controls max_iterations per sample
  batch_size: 64
  num_predict_steps: 4
  
  # Optimizer (for synthetic/hybrid)
  learning_rate: 0.0001
  optimizer: 'adam'
  scheduler: 'cosine'
  weight_decay: 0.0
  
  # Validation
  validate_every: 10
  validation_rollout_steps: 75

  # Physical model optimization settings
  method: 'L-BFGS-B'  # Gradient descent
  abs_tol: 1e-6
  max_iterations: 20  # Maximum optimization iterations
  
  # Checkpointing
  checkpoint_freq: 10
  print_freq: 10

  learnable_parameters:
    - name: 'nu'
      initial_guess: 0.01  # Starting value for optimization (closer to true value ~0.01)

evaluation_params:
  test_sim: [0]
  num_frames: 75
  metrics: ['mse', 'mae', 'rmse']
  save_animations: true
  save_plots: true

project_root: ${hydra:runtime.cwd}
